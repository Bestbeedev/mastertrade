import{u as Y,a as N,U as y,j as e,H as U,L as _,t as m}from"./app-B3Y0P8eL.js";import{A as J}from"./app-layout-BmrSMU7B.js";import{C as K,a as Q,b as C,c as w,d as W,e as X}from"./card-B6WQ6knZ.js";import{s as p,B as d}from"./index-BS9Mkhtc.js";import{I as c}from"./input-B58C95N6.js";import{C as D}from"./checkbox-BxdpT5nu.js";import{S as F,a as T,b as k,c as P,d as v}from"./select-CRiprpJX.js";import{L as n}from"./label-Dhbczhvd.js";import{T as Z,a as ee,b as h,c as x}from"./tabs-7x_I4q-o.js";import{D as se,a as ae,b as ie,c as te,d as re}from"./dialog-DgY4hv6z.js";import{D as S}from"./dropzone-BHNvWpXd.js";import{A as ne}from"./arrow-left-D1RE6sKu.js";import{T as g}from"./trash-2-nXQCgoxj.js";import{I as le}from"./info-Bj0kZ_4j.js";import{T as oe}from"./tag-BjPciNeU.js";import{F as de}from"./file-text-1gYjgS_u.js";import{I as ce}from"./image-CuGWnwnt.js";import{B as ue}from"./book-open-Bskm4tST.js";import{P as L}from"./plus-DJXp46-F.js";/* empty css            */import"./auth-ClV7ZO7P.js";import"./index-BJlpveyn.js";import"./index-DOpKAXXZ.js";import"./index-B7VOcpwy.js";import"./index-ChXgRNoH.js";import"./chevron-right-CR-mXq2c.js";import"./index-DN2tWQS9.js";import"./check-Dwe-_DrS.js";function Be(){const{course:l,products:z=[]}=Y().props,A=[{title:"Admin",href:"/admin"},{title:"Formations",href:"/admin/courses"},{title:l?.title||"Éditer",href:p("admin.courses.edit",l?.id)}],a=N({title:l?.title||"",description:l?.description||"",intro:l?.intro||"",what_you_will_learn:l?.what_you_will_learn||"",requirements:l?.requirements||"",audience:l?.audience||"",level:l?.level||"",tags:l?.tags||"",is_paid:!!l?.is_paid,price:l?.price??"",product_id:l?.product_id||"",cover_image:null,modules:(l?.modules||[]).map((s,t)=>({title:s.title,description:s.description||"",position:s.position??t,lessons:(s.lessons||[]).map((i,r)=>({title:i.title,type:i.type,content_url:i.content_url,is_preview:!!i.is_preview,duration_seconds:i.duration_seconds??"",position:i.position??r}))}))}),[q,I]=y.useState("info"),E=()=>{const s=[...a.data.modules||[]];s.push({title:"",description:"",position:s.length,lessons:[]}),a.setData("modules",s)},M=s=>{const t=[...a.data.modules||[]];t.splice(s,1),a.setData("modules",t.map((i,r)=>({...i,position:r})))},f=(s,t)=>{const i=[...a.data.modules||[]];i[s]={...i[s],...t},a.setData("modules",i)},$=s=>{const t=[...a.data.modules||[]],i=[...t[s]?.lessons||[]];i.push({title:"",type:"video",content_url:"",is_preview:!1,duration_seconds:"",position:i.length}),t[s]={...t[s],lessons:i},a.setData("modules",t)},B=(s,t)=>{const i=[...a.data.modules||[]],r=[...i[s]?.lessons||[]];r.splice(t,1),i[s]={...i[s],lessons:r.map((o,R)=>({...o,position:R}))},a.setData("modules",i)},u=(s,t,i)=>{const r=[...a.data.modules||[]],o=[...r[s]?.lessons||[]];o[t]={...o[t],...i},r[s]={...r[s],lessons:o},a.setData("modules",r)},O=s=>{s.preventDefault();const t=m.loading("Mise à jour de la formation...");a.transform(i=>({...i,_method:"patch"})),a.post(p("admin.courses.update",l.id),{onSuccess:()=>{m.success("Formation mise à jour",{id:t})},onError:()=>m.error("Erreur lors de la mise à jour",{id:t}),onFinish:()=>a.transform(i=>i),forceFormData:!0})},{delete:V,processing:b}=N({}),[H,j]=y.useState(!1),G=()=>{const s=m.loading("Suppression en cours...");V(p("admin.courses.destroy",l.id),{onSuccess:()=>{m.success("Formation supprimée",{id:s})},onError:()=>m.error("Erreur lors de la suppression",{id:s})})};return e.jsxs(J,{breadcrumbs:A,children:[e.jsx(U,{title:`Admin • Éditer ${l?.title||"Formation"}`}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{asChild:!0,variant:"outline",children:e.jsxs(_,{href:p("admin.courses"),children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Retour"]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(d,{variant:"destructive",onClick:()=>j(!0),disabled:b,children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Supprimer"]})})]}),e.jsx(se,{open:H,onOpenChange:s=>{s||j(!1)},children:e.jsxs(ae,{children:[e.jsxs(ie,{children:[e.jsx(te,{children:"Confirmer la suppression"}),e.jsx(re,{children:"Êtes-vous sûr de vouloir supprimer cette formation ? Cette action est définitive et supprimera l'ensemble des modules et leçons associés."})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(d,{variant:"outline",type:"button",onClick:()=>j(!1),children:"Annuler"}),e.jsx(d,{variant:"destructive",type:"button",onClick:()=>{j(!1),G()},disabled:b,children:"Supprimer"})]})]})}),e.jsx("form",{onSubmit:O,children:e.jsxs(K,{children:[e.jsxs(Q,{children:[e.jsx(C,{children:"Éditer la Formation"}),e.jsx(w,{children:"Personnalisez les informations, modules et leçons"})]}),e.jsx(W,{className:"space-y-6",children:e.jsxs(Z,{value:q,onValueChange:I,className:"space-y-4",children:[e.jsxs(ee,{children:[e.jsxs(h,{value:"info",className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"})," Infos"]}),e.jsxs(h,{value:"pricing",className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"})," Tarification"]}),e.jsxs(h,{value:"content",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"})," Contenu"]}),e.jsxs(h,{value:"media",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"})," Médias"]}),e.jsxs(h,{value:"modules",className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"})," Modules"]})]}),e.jsx(x,{value:"info",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"title",children:"Titre"}),e.jsx(c,{id:"title",value:a.data.title,onChange:s=>a.setData("title",s.target.value),required:!0})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"product_id",children:"Produit lié (optionnel)"}),e.jsxs(F,{value:a.data.product_id,onValueChange:s=>a.setData("product_id",s),children:[e.jsx(T,{className:"w-full",children:e.jsx(k,{placeholder:"Sélectionnez un produit"})}),e.jsx(P,{children:z?.map(s=>e.jsx(v,{value:s.id,children:s.name},s.id))})]})]})})]})}),e.jsx(x,{value:"pricing",className:"space-y-6",children:e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Payant ?"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{id:"is_paid",checked:!!a.data.is_paid,onCheckedChange:s=>a.setData("is_paid",!!s)}),e.jsx(n,{htmlFor:"is_paid",className:"text-sm text-muted-foreground",children:"Cocher si la formation est payante"})]})]}),a.data.is_paid&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"price",children:"Prix"}),e.jsx(c,{id:"price",type:"number",min:"0",step:"0.01",value:a.data.price,onChange:s=>a.setData("price",s.target.value)})]})]})})}),e.jsxs(x,{value:"content",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"intro",children:"Introduction (optionnel)"}),e.jsx("textarea",{id:"intro",value:a.data.intro,onChange:s=>a.setData("intro",s.target.value),rows:3,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",value:a.data.description,onChange:s=>a.setData("description",s.target.value),rows:4,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"what_you_will_learn",children:"Ce que vous apprendrez"}),e.jsx("textarea",{id:"what_you_will_learn",value:a.data.what_you_will_learn,onChange:s=>a.setData("what_you_will_learn",s.target.value),rows:4,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",placeholder:`Point 1
Point 2
Point 3`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"requirements",children:"Prérequis"}),e.jsx("textarea",{id:"requirements",value:a.data.requirements,onChange:s=>a.setData("requirements",s.target.value),rows:4,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",placeholder:`Compétence A
Outil B`})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(n,{htmlFor:"audience",children:"Pour qui ?"}),e.jsx("textarea",{id:"audience",value:a.data.audience,onChange:s=>a.setData("audience",s.target.value),rows:3,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",placeholder:"Débutants, Étudiants, Professionnels..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"level",children:"Niveau"}),e.jsx(c,{id:"level",value:a.data.level,onChange:s=>a.setData("level",s.target.value),placeholder:"Débutant / Intermédiaire / Avancé"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"tags",children:"Tags"}),e.jsx(c,{id:"tags",value:a.data.tags,onChange:s=>a.setData("tags",s.target.value),placeholder:"ex: sécurité, windows, réseau"})]})]})]}),e.jsx(x,{value:"media",className:"space-y-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Bannière de couverture"}),e.jsx(S,{accept:"image/*",multiple:!1,onFiles:s=>a.setData("cover_image",s[0]??null),children:e.jsx("span",{children:"Glissez-déposez une image ou cliquez pour sélectionner"})}),l?.cover_image&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Image actuelle:"}),l?.cover_image&&e.jsx("img",{src:`/storage/${l.cover_image}`,alt:"Cover",className:"h-24 rounded border"}),a.data.cover_image&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Nouvelle image: ",a.data.cover_image.name]})]})}),e.jsxs(x,{value:"modules",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Modules et Leçons"}),e.jsx(w,{children:"Organisez la formation par étapes/modules"})]}),e.jsxs(d,{type:"button",variant:"outline",onClick:E,className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"})," Ajouter un module"]})]}),e.jsx("div",{className:"space-y-4",children:(a.data.modules||[]).map((s,t)=>e.jsxs("div",{className:"rounded-md border p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"flex-1 grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{children:"Titre du module"}),e.jsx(c,{value:s.title,onChange:i=>f(t,{title:i.target.value}),placeholder:`Module ${t+1}`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{children:"Description"}),e.jsx(c,{value:s.description||"",onChange:i=>f(t,{description:i.target.value}),placeholder:"Description du module (optionnel)"})]})]}),e.jsx(d,{type:"button",variant:"destructive",size:"icon",onClick:()=>M(t),children:e.jsx(g,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{children:"Leçons"}),e.jsxs(d,{type:"button",variant:"secondary",onClick:()=>$(t),className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"})," Ajouter une leçon"]})]}),e.jsx("div",{className:"space-y-3",children:(s.lessons||[]).map((i,r)=>e.jsx("div",{className:"rounded border p-3 space-y-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-2 flex-1",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{children:"Titre"}),e.jsx(c,{value:i.title,onChange:o=>u(t,r,{title:o.target.value}),placeholder:"Titre de la leçon"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{children:"Type"}),e.jsxs(F,{value:i.type,onValueChange:o=>u(t,r,{type:o,content_url:"",file:void 0}),children:[e.jsx(T,{className:"w-full",children:e.jsx(k,{placeholder:"Type de contenu"})}),e.jsxs(P,{children:[e.jsx(v,{value:"video",children:"Vidéo (YouTube)"}),e.jsx(v,{value:"pdf",children:"PDF / Ebook"})]})]})]}),i.type==="video"?e.jsxs("div",{className:"space-y-1 md:col-span-2",children:[e.jsx(n,{children:"Lien YouTube"}),e.jsx(c,{value:i.content_url||"",onChange:o=>u(t,r,{content_url:o.target.value}),placeholder:"https://www.youtube.com/watch?v=..."})]}):e.jsxs("div",{className:"space-y-1 md:col-span-2",children:[e.jsx(n,{children:"Fichier PDF"}),e.jsx(S,{accept:"application/pdf",multiple:!1,onFiles:o=>u(t,r,{file:o[0]}),children:e.jsx("span",{children:"Glissez-déposez un PDF ou cliquez pour sélectionner"})}),i.content_url&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Fichier actuel: ",i.content_url]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{children:"Durée (secondes, optionnel)"}),e.jsx(c,{type:"number",min:"0",value:i.duration_seconds||"",onChange:o=>u(t,r,{duration_seconds:o.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{id:`prev_${t}_${r}`,checked:!!i.is_preview,onCheckedChange:o=>u(t,r,{is_preview:!!o})}),e.jsx(n,{htmlFor:`prev_${t}_${r}`,className:"text-sm",children:"Leçon d'aperçu (gratuite)"})]})]}),e.jsx(d,{type:"button",variant:"outline",size:"icon",onClick:()=>B(t,r),children:e.jsx(g,{className:"h-4 w-4"})})]})},r))})]})]},t))})]})]})}),e.jsxs(X,{className:"flex justify-between border-t px-6 py-4",children:[e.jsx(d,{type:"button",variant:"outline",asChild:!0,children:e.jsx(_,{href:p("admin.courses"),children:"Annuler"})}),e.jsx(d,{type:"submit",disabled:a.processing,children:a.processing?"Enregistrement...":"Enregistrer"})]})]})})]})]})}export{Be as default};
