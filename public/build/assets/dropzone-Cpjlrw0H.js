import{U as w,r as f,j as r}from"./app-CrawgoCe.js";import{b as N}from"./index-DsAE6S8J.js";import{X as L}from"./index-CWelApJs.js";function C({accept:o,multiple:a,onFiles:c,className:u,children:i,value:n=[],onRemove:l}){const d=w.useRef(null),[x,m]=f.useState(!1),[p,g]=f.useState([]);f.useEffect(()=>{const e=n.map(t=>({file:t,url:URL.createObjectURL(t)}));return g(t=>(t.forEach(s=>URL.revokeObjectURL(s.url)),e)),()=>{e.forEach(t=>URL.revokeObjectURL(t.url))}},[n]);const j=e=>{e.preventDefault(),e.stopPropagation(),m(!1);const t=Array.from(e.dataTransfer.files||[]);if(!t.length)return;const s=h(t,o);c(a?[...n,...s]:s.slice(0,1))},v=e=>{const t=Array.from(e.target.files||[]);if(!t.length)return;const s=h(t,o);c(a?[...n,...s]:s.slice(0,1)),d.current&&(d.current.value="")},b=(e,t)=>{if(e.stopPropagation(),l)l(t);else{const s=[...n];s.splice(t,1),c(s)}},y=e=>e.type.startsWith("image/");return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{onDragOver:e=>{e.preventDefault(),m(!0)},onDragLeave:()=>m(!1),onDrop:j,className:N("flex flex-col items-center justify-center gap-2 border-2 border-dashed rounded-md p-4 text-sm cursor-pointer transition-colors",x?"border-primary bg-primary/5":"border-muted",u),onClick:()=>d.current?.click(),role:"button",tabIndex:0,children:[i??r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-muted-foreground",children:"Glissez-déposez des fichiers ici, ou cliquez pour parcourir"}),o&&r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Formats acceptés: ",o]})]}),r.jsx("input",{ref:d,type:"file",accept:o,multiple:a,onChange:v,className:"hidden"})]}),p.length>0&&r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3",children:p.map((e,t)=>r.jsxs("div",{className:"relative group rounded-md overflow-hidden border border-muted",children:[y(e.file)?r.jsx("div",{className:"aspect-square bg-muted/50 flex items-center justify-center",children:r.jsx("img",{src:e.url,alt:e.file.name,className:"object-cover w-full h-full"})}):r.jsx("div",{className:"aspect-square bg-muted/50 flex items-center justify-center p-3",children:r.jsxs("div",{className:"text-center",children:[r.jsx(R,{className:"w-8 h-8 mx-auto text-muted-foreground mb-1"}),r.jsx("p",{className:"text-xs text-muted-foreground truncate w-full px-1",children:e.file.name})]})}),r.jsx("button",{type:"button",onClick:s=>b(s,t),className:"absolute -top-2 -right-2 bg-destructive text-destructive-foreground rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-destructive/90","aria-label":"Supprimer",children:r.jsx(L,{className:"w-3 h-3"})})]},t))})]})}function h(o,a){if(!a)return o;const c=a.split(",").map(i=>i.trim()).filter(Boolean);if(!c.length)return o;const u=i=>c.some(n=>{if(n==="*/*")return!0;if(n.endsWith("/*")){const l=n.split("/")[0];return i.type.startsWith(l+"/")}return i.type===n||i.name.toLowerCase().endsWith(n.replace("*","").toLowerCase())});return o.filter(u)}function R({className:o}){return r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:o,children:[r.jsx("path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}),r.jsx("path",{d:"M14 2v4a2 2 0 0 0 2 2h4"})]})}export{C as D};
