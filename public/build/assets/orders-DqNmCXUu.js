import{j as e,H as v,L as j,a as b}from"./app-CrawgoCe.js";import{A as y}from"./app-layout-DfcnZheQ.js";import{C as o,a as x,b as u,c as h,d as p}from"./card-CAnZI0ok.js";import{s as l,B as m,f as C}from"./index-DsAE6S8J.js";import{I as S}from"./input-B0f9F1lR.js";import{B as w}from"./auth-BgAybA0k.js";import{S as A,a as F,b as D,c as R,d}from"./select-PkxRjFfB.js";/* empty css            */import"./chevron-right-CbrF_LyD.js";import"./index-CWelApJs.js";import"./index-BSR4FWt4.js";import"./index-2DkYc2p9.js";import"./index-BJrNQDjd.js";import"./index-BANTq3rp.js";import"./check-BvN_zyQd.js";function K({orders:s,statusCounts:t={},filters:n={status:""}}){const r=Array.isArray(s?.data)?s.data:[],f=[{value:"pending",label:"En attente"},{value:"paid",label:"Payée"},{value:"failed",label:"Échouée"},{value:"refunded",label:"Remboursée"}],N=({s:a})=>{const i={pending:"secondary",paid:"default",failed:"destructive",refunded:"secondary"},c=f.find(g=>g.value===a)?.label||a;return e.jsx(w,{variant:i[a]||"outline",children:c})};return e.jsxs(y,{breadcrumbs:[{title:"Admin",href:l("admin")},{title:"Commandes",href:l("admin.orders")}],children:[e.jsx(v,{title:"Admin • Commandes"}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des commandes"}),e.jsx("p",{className:"text-muted-foreground",children:"Consultez et mettez à jour les commandes."})]}),e.jsx("div",{children:e.jsx(m,{asChild:!0,variant:"outline",size:"sm",children:e.jsx("a",{href:l("admin.orders.export",n.status?{status:n.status}:{}),children:"Exporter CSV"})})})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"pb-3",children:[e.jsx(u,{className:"text-base",children:"Filtres rapides"}),e.jsx(h,{children:"Par statut"})]}),e.jsx(p,{className:"flex flex-wrap gap-2",children:["","pending","paid","failed","refunded"].map(a=>e.jsx(m,{asChild:!0,variant:n.status===a?"default":"outline",size:"sm",children:e.jsx(j,{href:l("admin.orders",a?{status:a}:{}),children:a?e.jsxs(e.Fragment,{children:[e.jsx(N,{s:a}),e.jsx("span",{className:"ml-2",children:t?.[a]??0})]}):e.jsxs(e.Fragment,{children:["Tous",e.jsx("span",{className:"ml-2",children:Object.values(t||{}).reduce((i,c)=>i+c,0)})]})})},a||"all"))})]}),e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsx(u,{children:"Liste des commandes"}),e.jsxs(h,{children:[r.length," résultat",r.length>1?"s":""]})]}),e.jsx(p,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b",children:[e.jsx("th",{className:"py-2 pr-4",children:"Réf."}),e.jsx("th",{className:"py-2 pr-4",children:"Client"}),e.jsx("th",{className:"py-2 pr-4",children:"Produit"}),e.jsx("th",{className:"py-2 pr-4",children:"Montant"}),e.jsx("th",{className:"py-2 pr-4",children:"Statut"}),e.jsx("th",{className:"py-2 pr-4",children:"Date"}),e.jsx("th",{className:"py-2 pr-4 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:r.map(a=>e.jsx(z,{order:a},a.id))})]})})})]})]})]})}function z({order:s}){const t=b({status:s.status,amount:(typeof s.amount=="number"?s.amount:0)/100}),n=()=>{t.setData("amount",Math.round((Number(t.data.amount)||0)*100)),t.patch(l("admin.orders.update",s.id),{preserveScroll:!0})};return e.jsxs("tr",{className:"border-b align-top",children:[e.jsx("td",{className:"py-3 pr-4 font-mono text-xs",children:e.jsx(j,{href:l("admin.orders.show",s.id),className:"underline underline-offset-2",children:s.id})}),e.jsxs("td",{className:"py-3 pr-4",children:[e.jsx("div",{className:"font-medium",children:s.user?.name||"—"}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s.user?.email})]}),e.jsx("td",{className:"py-3 pr-4",children:s.product?.name||"—"}),e.jsx("td",{className:"py-3 pr-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{type:"number",min:0,step:"0.01",value:t.data.amount,onChange:r=>t.setData("amount",parseFloat(r.target.value||"0")||0),className:"w-28"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:C(s.amount||0)})]})}),e.jsx("td",{className:"py-3 pr-4",children:e.jsxs(A,{value:t.data.status,onValueChange:r=>t.setData("status",r),children:[e.jsx(F,{className:"w-36",children:e.jsx(D,{})}),e.jsxs(R,{children:[e.jsx(d,{value:"pending",children:"En attente"}),e.jsx(d,{value:"paid",children:"Payée"}),e.jsx(d,{value:"failed",children:"Échouée"}),e.jsx(d,{value:"refunded",children:"Remboursée"})]})]})}),e.jsx("td",{className:"py-3 pr-4 text-xs",children:s.created_at?new Date(s.created_at).toLocaleString("fr-FR"):""}),e.jsx("td",{className:"py-3 pr-0 text-right",children:e.jsx(m,{size:"sm",onClick:n,disabled:t.processing,children:t.processing?"...":"Enregistrer"})})]})}export{K as default};
