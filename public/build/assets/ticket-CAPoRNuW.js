import{u as k,r as T,j as e,H as X,L as d,b as E}from"./app-B3Y0P8eL.js";import{A as Y}from"./app-layout-BmrSMU7B.js";import{c as Z,B as m,s as x}from"./index-BS9Mkhtc.js";import{I as ee}from"./input-B58C95N6.js";import{C as p,a as j,b as f,d as u,c as se}from"./card-B6WQ6knZ.js";import{B as A}from"./auth-ClV7ZO7P.js";import{S as te,a as re,b as ae,c as le,d as v}from"./select-CRiprpJX.js";import{C as I}from"./circle-alert-CpR5lEv3.js";import{C as F}from"./circle-check-big-CseRTbwM.js";import{C as M}from"./clock-CWl00VTJ.js";import{P}from"./plus-DJXp46-F.js";import{C as ie}from"./circle-help-D8rWDz6I.js";import{P as ne}from"./phone-C-IqPVJh.js";import{S as oe}from"./search-DX38BU3V.js";import{F as ce}from"./filter-DqkK9KL2.js";import{C as de}from"./chevron-right-CR-mXq2c.js";import{M as D}from"./message-circle-BVVNbpXu.js";/* empty css            */import"./index-BJlpveyn.js";import"./index-DOpKAXXZ.js";import"./index-B7VOcpwy.js";import"./index-ChXgRNoH.js";import"./index-DN2tWQS9.js";import"./check-Dwe-_DrS.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],xe=Z("Mail",me);function Ie(){const R=[{title:"Tickets et Support",href:"/client/ticket"}],N=k().props,H=N.filters?.status??"all",K=N.filters?.search??"",V=N.filters?.sort??"recent",[r,_]=T.useState(H),[n,O]=T.useState(K),[$,U]=T.useState(V),{tickets:o=[],ticketsCounts:h=null}=k().props,q=!!k().props?.isAdmin,b=Array.isArray(o)?null:o??null,z=Array.isArray(o)?o:o?.data??[],y=s=>s==="in_progress"?"pending":s==="resolved"?"closed":["open","pending","closed"].includes(s)?s:"open",l=h??z.reduce((s,t)=>{const a=y(t.status??"open");return s.all+=1,s[a]+=1,s},{all:0,open:0,pending:0,closed:0}),L=[{id:"all",label:"Tous les tickets",count:l.all},{id:"open",label:"Ouverts",count:l.open},{id:"pending",label:"En cours",count:l.pending},{id:"closed",label:"Fermés",count:l.closed}],w=s=>{E.get(x("supportsTickets"),{status:r,search:n,sort:$,...s},{preserveState:!0,replace:!0,preserveScroll:!0})},B=n.trim().toLowerCase(),g=z.filter(s=>{const t=s.status??"open",a=y(t),c=r==="all"||a===r,C=[s.subject,s.description,s.message,s.id].map(S=>(S??"").toString().toLowerCase()).join(" "),i=B===""||C.includes(B);return c&&i}),G={open:{variant:"destructive",text:"Ouvert",icon:I},pending:{variant:"default",text:"En cours",icon:M},closed:{variant:"secondary",text:"Fermé",icon:F}},Q={high:{color:"text-red-600",bg:"bg-red-100 dark:bg-red-900/20",text:"Élevée"},medium:{color:"text-yellow-600",bg:"bg-yellow-100 dark:bg-yellow-900/20",text:"Moyenne"},low:{color:"text-blue-600",bg:"bg-blue-100 dark:bg-blue-900/20",text:"Basse"}},W=[{title:"Tickets ouverts",value:l.open.toString(),description:"En attente de traitement",color:"text-orange-600",icon:I},{title:"Taux de résolution",value:l.all>0?`${Math.round(l.closed/l.all*100)}%`:"0%",description:"Tickets fermés",color:"text-green-600",icon:F},{title:"Temps moyen",value:"2h",description:"Réponse support",color:"text-blue-600",icon:M}],J=[{title:"Centre d'aide",description:"Documentation et FAQ",icon:ie,href:"/client/help",color:"text-blue-600"},{title:"Support téléphonique",description:"01 23 45 67 89",icon:ne,href:"tel:+33123456789",color:"text-green-600"},{title:"Email support",description:"support@votreentreprise.com",icon:xe,href:"mailto:support@votreentreprise.com",color:"text-purple-600"}];return e.jsxs(Y,{breadcrumbs:R,children:[e.jsx(X,{title:"Tickets et Support"}),e.jsx("div",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Tickets et Support"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Gérez vos demandes d'assistance et suivez leur résolution"})]}),e.jsx(m,{asChild:!0,children:e.jsxs(d,{href:x("supportsTickets.create"),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Nouveau ticket"]})})]})})}),e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(p,{children:[e.jsx(j,{className:"pb-4",children:e.jsx(f,{className:"text-lg",children:"Filtres"})}),e.jsx(u,{className:"p-0",children:e.jsx("div",{className:"space-y-1 p-2",children:L.map(s=>e.jsxs("button",{onClick:()=>{h?(_(s.id),w({status:s.id})):_(s.id)},className:`w-full flex items-center justify-between p-3 rounded-lg text-left transition-colors ${r===s.id?"bg-primary text-primary-foreground":"hover:bg-accent"}`,children:[e.jsx("span",{className:"text-sm",children:s.label}),e.jsx(A,{variant:"secondary",className:r===s.id?"bg-primary-foreground text-primary":"",children:s.count})]},s.id))})})]}),e.jsxs(p,{children:[e.jsx(j,{className:"pb-4",children:e.jsx(f,{className:"text-lg",children:"Contact support"})}),e.jsx(u,{className:"space-y-4",children:J.map((s,t)=>{const a=s.icon;return e.jsx(m,{variant:"outline",className:"w-full justify-start h-auto p-3",asChild:!0,children:e.jsxs(d,{href:s.href,children:[e.jsx(a,{className:`h-4 w-4 mr-3 ${s.color}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-sm font-medium",children:s.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.description})]})]})},t)})})]}),e.jsxs(p,{children:[e.jsx(j,{className:"pb-4",children:e.jsx(f,{className:"text-lg",children:"Statut du support"})}),e.jsxs(u,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"En ligne"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("div",{children:"• Réponse sous 2h en moyenne"}),e.jsx("div",{children:"• Disponible 24h/24"}),e.jsx("div",{children:"• Priorité selon urgence"})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ee,{placeholder:"Rechercher dans les tickets...",className:"pl-10",value:n,onChange:s=>{const t=s.target.value;O(t),h&&w({search:t})}})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(te,{value:$,onValueChange:s=>{U(s),h&&w({sort:s})},children:[e.jsx(re,{className:"w-40",children:e.jsx(ae,{placeholder:"Trier par"})}),e.jsxs(le,{children:[e.jsx(v,{value:"recent",children:"Plus récent"}),e.jsx(v,{value:"old",children:"Plus ancien"}),e.jsx(v,{value:"priority",children:"Priorité"}),e.jsx(v,{value:"status",children:"Statut"})]})]}),e.jsxs(m,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Filtres avancés"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:W.map((s,t)=>{const a=s.icon;return e.jsx(p,{children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-muted",children:e.jsx(a,{className:`h-5 w-5 ${s.color}`})}),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${s.color}`,children:s.value}),e.jsx("div",{className:"text-sm font-medium",children:s.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.description})]})]})})},t)})}),e.jsxs(p,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(f,{children:[r==="all"?"Tous les tickets":L.find(s=>s.id===r)?.label,e.jsxs("span",{className:"text-muted-foreground ml-2 font-normal",children:["(",g.length,")"]})]}),e.jsx(se,{children:"Suivez l'avancement de vos demandes de support"})]}),g.length>0&&e.jsx(m,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(d,{href:x("supportsTickets.create"),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Nouveau ticket"]})})]})}),e.jsxs(u,{className:"p-0",children:[e.jsx("div",{className:"divide-y",children:g.map(s=>{const t=s.status??"open",a=y(t),c=G[a],C=s.priority??"medium",i=Q[C],S=c.icon;return e.jsx(d,{href:x("supportsTickets.show",s.id),className:"block p-6 hover:bg-accent/50 transition-colors group",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.bg} flex-shrink-0`,children:e.jsx(S,{className:`h-5 w-5 ${i.color}`})}),e.jsxs("div",{className:"space-y-2 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2",children:[e.jsx("h3",{className:"font-semibold text-lg group-hover:text-primary transition-colors truncate",children:s.subject}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(A,{variant:c.variant,className:"text-xs",children:c.text}),e.jsx(de,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]})]}),e.jsx("p",{className:"text-muted-foreground line-clamp-2 text-sm",children:s.description??s.message}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-muted-foreground",children:[q&&(s.user?.name||s.user?.email)?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium",children:s.user?.name??"Utilisateur"}),s.user?.email?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"font-mono",children:s.user.email})]}):null,e.jsx("span",{children:"•"})]}):null,e.jsxs("span",{className:"font-mono",children:["#",s.id]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Créé le: ",s.date??(s.created_at?new Date(s.created_at).toLocaleDateString("fr-FR"):"N/A")]}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),s.messages_count??s.messages??1," messages"]}),s.category&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx(A,{variant:"outline",className:"text-xs",children:s.category})]})]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:s.lastUpdate||(s.updated_at?`Modifié ${new Date(s.updated_at).toLocaleDateString("fr-FR")}`:"")}),e.jsxs("div",{className:`px-2 py-1 rounded text-xs font-medium ${i.bg} ${i.color}`,children:["Priorité ",i.text]})]})]})},s.id)})}),g.length===0&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(D,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:n||r!=="all"?"Aucun ticket trouvé":"Aucun ticket"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:n||r!=="all"?"Aucun ticket ne correspond à vos critères de recherche. Essayez de modifier vos filtres.":"Vous n'avez pas encore créé de ticket de support. Créez votre premier ticket pour obtenir de l'aide."}),e.jsx(m,{asChild:!0,size:"lg",children:e.jsxs(d,{href:x("supportsTickets.create"),children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Créer un ticket"]})})]})]})]}),b?.links&&b.links.length>3&&e.jsx("div",{className:"flex items-center justify-center gap-1",children:b.links.map((s,t)=>e.jsx("button",{disabled:!s.url,onClick:()=>{s.url&&E.get(s.url,{},{preserveState:!0,preserveScroll:!0})},className:`px-3 py-2 rounded border text-sm min-w-[40px] ${s.active?"bg-primary text-primary-foreground border-primary":"hover:bg-accent border-border"} ${s.url?"":"opacity-50 cursor-not-allowed"}`,dangerouslySetInnerHTML:{__html:s.label}},t))})]})]})})]})}export{Ie as default};
