import{u as f,a as g,j as e,H as v,L as b,t as a}from"./app-CrawgoCe.js";import{A as N}from"./app-layout-DfcnZheQ.js";import{C,a as k,b as y,c as D,d as S,e as F}from"./card-CAnZI0ok.js";import{B as c,s as l}from"./index-DsAE6S8J.js";import{I as _}from"./input-B0f9F1lR.js";import{L as r}from"./label-BOOWJvQK.js";import{S as o,a as n,b as d,c as m,d as u}from"./select-PkxRjFfB.js";import{D as w}from"./dropzone-Cpjlrw0H.js";/* empty css            */import"./auth-BgAybA0k.js";import"./index-CWelApJs.js";import"./index-BSR4FWt4.js";import"./index-2DkYc2p9.js";import"./index-BJrNQDjd.js";import"./chevron-right-CbrF_LyD.js";import"./index-BANTq3rp.js";import"./check-BvN_zyQd.js";function O(){const{orders:p=[],licenses:x=[]}=f().props,h=[{title:"Tickets",href:"/client/ticket"},{title:"Nouveau",href:"/client/ticket/new"}],t=g({subject:"",message:"",order_id:"",license_id:"",priority:"medium",category:"",attachments:[]}),j=s=>{s.preventDefault();const i=a.loading("Création du ticket...");t.post(l("supportsTickets.store"),{onSuccess:()=>{a.success("Ticket créé avec succès",{id:i})},onError:()=>a.error("Impossible de créer le ticket",{id:i}),forceFormData:!0})};return e.jsxs(N,{breadcrumbs:h,children:[e.jsx(v,{title:"Nouveau ticket"}),e.jsx("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("form",{onSubmit:j,children:e.jsxs(C,{children:[e.jsxs(k,{children:[e.jsx(y,{children:"Nouveau ticket de support"}),e.jsx(D,{children:"Décrivez votre problème ou votre demande. Joignez une commande ou une licence si pertinent."})]}),e.jsx(S,{className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"subject",children:"Sujet"}),e.jsx(_,{id:"subject",value:t.data.subject,onChange:s=>t.setData("subject",s.target.value),placeholder:"Sujet du ticket",required:!0}),t.errors.subject&&e.jsx("p",{className:"text-sm text-destructive",children:t.errors.subject})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Pièces jointes (optionnel)"}),e.jsx(w,{multiple:!0,accept:"image/*,application/pdf,text/plain,application/zip",value:t.data.attachments||[],onFiles:s=>t.setData("attachments",s),className:"min-h-[100px]",children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx("p",{className:"text-muted-foreground",children:"Glissez-déposez des fichiers ici ou cliquez pour sélectionner"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Formats acceptés: images, PDF, texte, ZIP"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"order_id",children:"Commande liée (optionnel)"}),e.jsxs(o,{value:t.data.order_id,onValueChange:s=>t.setData("order_id",s),children:[e.jsx(n,{className:"w-full",children:e.jsx(d,{placeholder:"Sélectionner une commande"})}),e.jsx(m,{className:"w-full",children:p.map(s=>e.jsxs(u,{value:s.id,children:[s.id," • ",s.product?.name??"Produit"]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"license_id",children:"Licence liée (optionnel)"}),e.jsxs(o,{value:t.data.license_id,onValueChange:s=>t.setData("license_id",s),children:[e.jsx(n,{className:"w-full",children:e.jsx(d,{placeholder:"Sélectionner une licence"})}),e.jsx(m,{children:x.map(s=>e.jsxs(u,{value:s.id,children:[s.id," • ",s.product?.name??"Produit"]},s.id))})]})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-1",children:[e.jsx(r,{htmlFor:"message",children:"Message"}),e.jsx("textarea",{id:"message",placeholder:"Décrivez votre problème avec le plus de détails possible...",value:t.data.message,onChange:s=>t.setData("message",s.target.value),rows:10,className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",required:!0}),t.errors.message&&e.jsx("p",{className:"text-sm text-destructive",children:t.errors.message})]})]})}),e.jsxs(F,{className:"flex justify-between border-t px-6 py-4",children:[e.jsx(c,{type:"button",variant:"outline",asChild:!0,children:e.jsx(b,{href:l("supportsTickets"),children:"Annuler"})}),e.jsx(c,{type:"submit",disabled:t.processing,children:t.processing?"Création...":"Créer le ticket"})]})]})})})]})}export{O as default};
