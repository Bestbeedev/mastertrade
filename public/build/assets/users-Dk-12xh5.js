import{U as p,a as v,j as e,H as X,b as Y,t}from"./app-CrawgoCe.js";import{A as Z}from"./app-layout-DfcnZheQ.js";import{C as N,a as D,b as S,c as w,d as T}from"./card-CAnZI0ok.js";import{B as n,s as x}from"./index-DsAE6S8J.js";import{I as l}from"./input-B0f9F1lR.js";import{L as i}from"./label-BOOWJvQK.js";import{S as _,a as E,b as F,c as A,d as U}from"./select-PkxRjFfB.js";import{T as $,a as ee,b as q,c as L}from"./tabs-BB3rli4r.js";import{T as se,a as ae,b as R,c,d as re,e as o,f as ie}from"./table-z59bnX-N.js";import{D as k,a as H,b as M,c as V,d as z}from"./dialog-DUMmkX7I.js";/* empty css            */import"./auth-BgAybA0k.js";import"./index-CWelApJs.js";import"./index-BSR4FWt4.js";import"./index-2DkYc2p9.js";import"./index-BJrNQDjd.js";import"./chevron-right-CbrF_LyD.js";import"./index-BANTq3rp.js";import"./check-BvN_zyQd.js";function De({users:g=[],roles:y=[],filters:B={}}){const[I,f]=p.useState("list"),[C,P]=p.useState(B.q??""),[u,m]=p.useState(null),[j,h]=p.useState(null),a=v({name:"",email:"",password:"",phone:"",country:"",role_id:""}),r=v({name:"",email:"",password:"",phone:"",country:"",role_id:""}),{delete:O,processing:b}=v({}),G=s=>{s.preventDefault(),Y.get(x("admin.users"),{q:C},{preserveState:!0,replace:!0})},Q=s=>{s.preventDefault();const d=t.loading("Création de l'utilisateur...");a.post(x("admin.users.store"),{onSuccess:()=>{t.success("Utilisateur créé",{id:d}),a.reset(),f("list")},onError:()=>t.error("Erreur lors de la création",{id:d})})},J=s=>{m(s),r.setData({name:s.name??"",email:s.email??"",password:"",phone:s.phone??"",country:s.country??"",role_id:s.role_id??""})},K=s=>{if(s.preventDefault(),!u)return;const d=t.loading("Mise à jour de l'utilisateur...");r.patch(x("admin.users.update",{user:u.id}),{onSuccess:()=>{t.success("Utilisateur mis à jour",{id:d}),m(null)},onError:()=>t.error("Erreur lors de la mise à jour",{id:d}),preserveScroll:!0})},W=()=>{if(!j)return;const s=t.loading("Suppression de l'utilisateur..."),d=j.id;O(x("admin.users.destroy",{user:d}),{onSuccess:()=>{t.success("Utilisateur supprimé",{id:s}),h(null)},onError:()=>t.error("Erreur lors de la suppression",{id:s}),preserveScroll:!0})};return e.jsxs(Z,{breadcrumbs:[{title:"Admin",href:"/admin"},{title:"Utilisateurs",href:"/admin/users"}],children:[e.jsx(X,{title:"Admin • Utilisateurs"}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des Utilisateurs"}),e.jsx("p",{className:"text-muted-foreground",children:"Créer, rechercher et administrer les utilisateurs"})]})}),e.jsxs($,{value:I,onValueChange:f,className:"space-y-4",children:[e.jsxs(ee,{children:[e.jsx(q,{value:"list",children:"Liste"}),e.jsx(q,{value:"new",children:"Nouveau"})]}),e.jsx(L,{value:"list",className:"space-y-4",children:e.jsxs(N,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"Utilisateurs"}),e.jsx(w,{children:"Liste des utilisateurs"})]}),e.jsxs(T,{children:[e.jsxs("form",{onSubmit:G,className:"flex items-center gap-2 mb-4",children:[e.jsx(l,{value:C,onChange:s=>P(s.target.value),placeholder:"Recherche nom ou email"}),e.jsx(n,{type:"submit",variant:"outline",children:"Rechercher"})]}),e.jsx("div",{children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsxs(R,{children:[e.jsx(c,{children:"Nom"}),e.jsx(c,{children:"Email"}),e.jsx(c,{children:"Rôle"}),e.jsx(c,{children:"Pays"}),e.jsx(c,{children:"Téléphone"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(re,{children:g.map(s=>e.jsxs(R,{children:[e.jsx(o,{className:"font-medium",children:s.name}),e.jsx(o,{children:s.email}),e.jsx(o,{children:s.role?.name??"—"}),e.jsx(o,{children:s.country??"—"}),e.jsx(o,{children:s.phone??"—"}),e.jsxs(o,{className:"space-x-2",children:[e.jsx(n,{size:"sm",variant:"outline",onClick:()=>J(s),children:"Éditer"}),e.jsx(n,{size:"sm",variant:"destructive",onClick:()=>h(s),disabled:b,children:"Supprimer"})]})]},s.id))}),g.length===0&&e.jsx(ie,{children:"Aucun utilisateur"})]})}),e.jsx(k,{open:!!u,onOpenChange:s=>{s||m(null)},children:e.jsxs(H,{className:"max-w-4xl lg:max-w-6xl xl:max-w-7xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(M,{children:[e.jsx(V,{children:"Modifier l'utilisateur"}),e.jsx(z,{children:"Mettez à jour les informations de l'utilisateur sélectionné."})]}),u&&e.jsxs("form",{onSubmit:K,className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"e_name",children:"Nom"}),e.jsx(l,{id:"e_name",value:r.data.name,onChange:s=>r.setData("name",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"e_email",children:"Email"}),e.jsx(l,{id:"e_email",type:"email",value:r.data.email,onChange:s=>r.setData("email",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"e_password",children:"Mot de passe"}),e.jsx(l,{id:"e_password",type:"password",placeholder:"Laisser vide pour conserver",value:r.data.password,onChange:s=>r.setData("password",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"e_phone",children:"Téléphone"}),e.jsx(l,{id:"e_phone",value:r.data.phone,onChange:s=>r.setData("phone",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"e_country",children:"Pays"}),e.jsx(l,{id:"e_country",value:r.data.country,onChange:s=>r.setData("country",s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Rôle"}),e.jsxs(_,{value:r.data.role_id||"",onValueChange:s=>r.setData("role_id",s),children:[e.jsx(E,{className:"w-full",children:e.jsx(F,{placeholder:"Sélectionner"})}),e.jsx(A,{children:y.map(s=>e.jsx(U,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(n,{type:"button",variant:"ghost",onClick:()=>m(null),children:"Annuler"}),e.jsx(n,{type:"submit",children:"Enregistrer"})]})]})]})}),e.jsx(k,{open:!!j,onOpenChange:s=>{s||h(null)},children:e.jsxs(H,{children:[e.jsxs(M,{children:[e.jsx(V,{children:"Confirmer la suppression"}),e.jsx(z,{children:"Êtes-vous sûr de vouloir supprimer cet utilisateur ? Cette action est définitive et supprimera ses accès à la plateforme."})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(n,{variant:"outline",type:"button",onClick:()=>h(null),children:"Annuler"}),e.jsx(n,{variant:"destructive",type:"button",onClick:W,disabled:b,children:"Supprimer"})]})]})})]})]})}),e.jsx(L,{value:"new",children:e.jsx("form",{onSubmit:Q,children:e.jsxs(N,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"Nouvel utilisateur"}),e.jsx(w,{children:"Créer un utilisateur"})]}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",children:"Nom"}),e.jsx(l,{id:"name",value:a.data.name,onChange:s=>a.setData("name",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"email",children:"Email"}),e.jsx(l,{id:"email",type:"email",value:a.data.email,onChange:s=>a.setData("email",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"password",children:"Mot de passe"}),e.jsx(l,{id:"password",type:"password",value:a.data.password,onChange:s=>a.setData("password",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"phone",children:"Téléphone"}),e.jsx(l,{id:"phone",value:a.data.phone,onChange:s=>a.setData("phone",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"country",children:"Pays"}),e.jsx(l,{id:"country",value:a.data.country,onChange:s=>a.setData("country",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Rôle"}),e.jsxs(_,{value:a.data.role_id||"",onValueChange:s=>a.setData("role_id",s),children:[e.jsx(E,{className:"w-full",children:e.jsx(F,{placeholder:"Sélectionner"})}),e.jsx(A,{children:y.map(s=>e.jsx(U,{value:s.id,children:s.name},s.id))})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(n,{type:"submit",children:"Créer"})})]})]})})})]})]})]})}export{De as default};
